---
title: Farey Numbers and Linked Lists
date: '2024-04-10'
slug: farey-linked-list
---

<script src="{{< blogdown/postref >}}index_files/header-attrs/header-attrs.js"></script>


<p>The Farey Numbers are a neat coordinate system for linked lists.</p>
<!--more-->
<style type="text/css">
body {
    line-height: 3em !important;
}

.katex {
    font-size: 1.1em !important;
    /*line-height: 1.7em !important;*/
    padding: 0 .15em;
    white-space: nowrap;
}

.yep {
  text-align:center;
}
</style>
<div id="farey-numbers" class="section level2">
<h2>Farey Numbers</h2>
<p>Farey numbers are fractions. The first two Farey numbers are <span class="math inline">\(\displaystyle\frac{0}{1}\)</span> and <span class="math inline">\(\displaystyle\frac{1}{1}\)</span>. If you have two Farey numbers <span class="math inline">\(\displaystyle\frac{a}{c}\)</span> and <span class="math inline">\(\displaystyle\frac{b}{d}\)</span>, you can make a new Farey number <span class="math inline">\(\displaystyle\frac{e}{f}\)</span> by summing their numerators and denominators.</p>
<p><span class="math display">\[ \displaystyle\frac{e}{f} = \frac{a+b}{c+d} \]</span></p>
<p>The new Farey number will always be strictly between the first two, so if <span class="math inline">\(\displaystyle\frac{b}{d}\)</span> were the larger of the two then</p>
<p><span class="math display">\[ \frac{a}{c} &lt; \space\frac{a+b}{c+d}\space&lt; \frac{b}{d} \]</span></p>
<p>We have two Farey numbers, so we can make another one between them. According to the rule, that number is <span class="math inline">\(\displaystyle\frac{0 + 1}{1 + 1}=\frac{1}{2}\)</span> . Our list of Farey numbers is now
<span class="math display">\[
\Biggl \{ \frac{0}{1}, \frac{1}{2}, \frac{1}{1} \Biggr \}
\]</span></p>
<p>Now we can make two more Farey numbers. Inserting between <span class="math inline">\(\displaystyle\frac{0}{1}\)</span> and <span class="math inline">\(\displaystyle\frac{1}{2}\)</span> gives us <span class="math inline">\(\displaystyle\frac{0+1}{1+2}=\frac{1}{3}\)</span>. Inserting between <span class="math inline">\(\displaystyle\frac{1}{2}\)</span> and <span class="math inline">\(\displaystyle\frac{1}{1}\)</span> gives us <span class="math inline">\(\displaystyle\frac{1+1}{2+1}=\frac{2}{3}\)</span>. Now our list is</p>
<p><span class="math display">\[ \Biggl \{ \frac{0}{1}, \frac{1}{3}, \frac{1}{2}, \frac{2}{3}, \frac{1}{1} \Biggr \} \]</span></p>
<p>Now we can make four more Farey Numbers. If we make them all, our list becomes</p>
<p><span class="math display">\[ \Biggl \{ \frac{0}{1}, \frac{1}{4}, \frac{1}{3}, \frac{2}{5}, \frac{1}{2}, \frac{3}{5}, \frac{2}{3}, \frac{3}{4}, \frac{1}{1} \Biggr \} \]</span></p>
<p>We can continue making new Farey numbers forever and we’ll never make the same Farey number twice. Also we’ll never make Farey numbers that are equivalent fractions. So, for example, since we’ve already made <span class="math inline">\(\displaystyle\frac{1}{2}\)</span> that means we’ll never make <span class="math inline">\(\displaystyle\frac{1}{2}\)</span> again, and we’ll also never make any of <span class="math inline">\(\displaystyle\Biggl\{\frac{2}{4},\frac{3}{6},\frac{4}{8}, ... \Biggr\}\)</span>.</p>
</div>
<div id="linked-lists" class="section level2">
<h2>Linked Lists</h2>
<p>A linked list is sequence of elements, each one linked to the next. The first two elements are the begin and end of the list.</p>
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="73" width="120" font-family="Menlo,Lucida Console,monospace">
<style type="text/css">svg {   color: #000000;}@media (prefers-color-scheme: dark) {   svg {      color: #000000;   }}</style>
<g transform='translate(8,16)'><path d='M 40,16 L 88,16' fill='none' stroke='currentColor'></path><polygon points='88.000000,16.000000 76.000000,10.400000 76.000000,21.600000' fill='currentColor' transform='rotate(0.000000, 88.000000, 16.000000)'></polygon><circle cx='40' cy='16' r='6' stroke='currentColor' fill='currentColor'></circle><circle cx='96' cy='16' r='6' stroke='currentColor' fill='currentColor'></circle>
<style>  text {       text-anchor: middle;       font-family: "Menlo","Lucida Console","monospace";       fill: currentColor;       font-size: 1em;  }</style>
<text x='24' y='52'>b</text><text x='32' y='52'>e</text><text x='40' y='52'>g</text><text x='48' y='52'>i</text><text x='56' y='52'>n</text><text x='88' y='52'>e</text><text x='96' y='52'>n</text><text x='104' y='52'>d</text></g>
</svg>
<p>If you have two elements of a linked list, you can make a new element between them. We have the begin and end of the list, so we can make another one between them. Our linked list now looks like this.</p>
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="89" width="208" font-family="Menlo,Lucida Console,monospace">
<style type="text/css">svg {   color: #000000;}@media (prefers-color-scheme: dark) {   svg {      color: #000000;   }}</style>
<g transform='translate(8,16)'><path d='M 40,32 L 88,32' fill='none' stroke='currentColor'></path><path d='M 128,32 L 176,32' fill='none' stroke='currentColor'></path><polygon points='96.000000,32.000000 84.000000,26.400000 84.000000,37.599998' fill='currentColor' transform='rotate(0.000000, 88.000000, 32.000000)'></polygon><polygon points='176.000000,32.000000 164.000000,26.400000 164.000000,37.599998' fill='currentColor' transform='rotate(0.000000, 176.000000, 32.000000)'></polygon><path d='M 112,16 A 16,16 0 0,0 96,32' fill='none' stroke='currentColor'></path><path d='M 112,16 A 16,16 0 0,1 128,32' fill='none' stroke='currentColor'></path><path d='M 96,32 A 16,16 0 0,0 112,48' fill='none' stroke='currentColor'></path><path d='M 128,32 A 16,16 0 0,1 112,48' fill='none' stroke='currentColor'></path><circle cx='40' cy='32' r='6' stroke='currentColor' fill='currentColor'></circle><circle cx='184' cy='32' r='6' stroke='currentColor' fill='currentColor'></circle>
<style>  text {       text-anchor: middle;       font-family: "Menlo","Lucida Console","monospace";       fill: currentColor;       font-size: 1em;  }</style>
<text x='24' y='68'>b</text><text x='32' y='68'>e</text><text x='40' y='68'>g</text><text x='48' y='68'>i</text><text x='56' y='68'>n</text><text x='176' y='68'>e</text><text x='184' y='68'>n</text><text x='192' y='68'>d</text></g>
</svg>
<p>We need a name for that node so we can talk about it. It was inserted between <strong>b</strong>egin and <strong>e</strong>nd, so we’ll call it <strong>be</strong>.</p>
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="89" width="200" font-family="Menlo,Lucida Console,monospace">
<style type="text/css">svg {   color: #000000;}@media (prefers-color-scheme: dark) {   svg {      color: #000000;   }}</style>
<g transform='translate(8,16)'><path d='M 40,32 L 88,32' fill='none' stroke='currentColor'></path><path d='M 128,32 L 176,32' fill='none' stroke='currentColor'></path><polygon points='96.000000,32.000000 84.000000,26.400000 84.000000,37.599998' fill='currentColor' transform='rotate(0.000000, 88.000000, 32.000000)'></polygon><polygon points='176.000000,32.000000 164.000000,26.400000 164.000000,37.599998' fill='currentColor' transform='rotate(0.000000, 176.000000, 32.000000)'></polygon><path d='M 112,16 A 16,16 0 0,0 96,32' fill='none' stroke='currentColor'></path><path d='M 112,16 A 16,16 0 0,1 128,32' fill='none' stroke='currentColor'></path><path d='M 96,32 A 16,16 0 0,0 112,48' fill='none' stroke='currentColor'></path><path d='M 128,32 A 16,16 0 0,1 112,48' fill='none' stroke='currentColor'></path><circle cx='40' cy='32' r='6' stroke='currentColor' fill='currentColor'></circle><circle cx='184' cy='32' r='6' stroke='currentColor' fill='currentColor'></circle>
<style>  text {       text-anchor: middle;       font-family: "Menlo","Lucida Console","monospace";       fill: currentColor;       font-size: 1em;  }</style>
<text x='40' y='68'>b</text><text x='104' y='68'>b</text><text x='112' y='68'>e</text><text x='184' y='68'>e</text></g>
</svg>
<p>Now we can make two new elements. Inserting between b and be gives us <strong>bee</strong>. Inserting between <strong>be</strong> and <strong>e</strong> gives us <strong>bee</strong>. Now our list is</p>
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="89" width="376" font-family="Menlo,Lucida Console,monospace">
<style type="text/css">svg {   color: #000000;}@media (prefers-color-scheme: dark) {   svg {      color: #000000;   }}</style>
<g transform='translate(8,16)'><path d='M 40,32 L 88,32' fill='none' stroke='currentColor'></path><path d='M 128,32 L 176,32' fill='none' stroke='currentColor'></path><path d='M 216,32 L 264,32' fill='none' stroke='currentColor'></path><path d='M 304,32 L 352,32' fill='none' stroke='currentColor'></path><polygon points='96.000000,32.000000 84.000000,26.400000 84.000000,37.599998' fill='currentColor' transform='rotate(0.000000, 88.000000, 32.000000)'></polygon><polygon points='184.000000,32.000000 172.000000,26.400000 172.000000,37.599998' fill='currentColor' transform='rotate(0.000000, 176.000000, 32.000000)'></polygon><polygon points='272.000000,32.000000 260.000000,26.400000 260.000000,37.599998' fill='currentColor' transform='rotate(0.000000, 264.000000, 32.000000)'></polygon><polygon points='352.000000,32.000000 340.000000,26.400000 340.000000,37.599998' fill='currentColor' transform='rotate(0.000000, 352.000000, 32.000000)'></polygon><path d='M 112,16 A 16,16 0 0,0 96,32' fill='none' stroke='currentColor'></path><path d='M 112,16 A 16,16 0 0,1 128,32' fill='none' stroke='currentColor'></path><path d='M 200,16 A 16,16 0 0,0 184,32' fill='none' stroke='currentColor'></path><path d='M 200,16 A 16,16 0 0,1 216,32' fill='none' stroke='currentColor'></path><path d='M 288,16 A 16,16 0 0,0 272,32' fill='none' stroke='currentColor'></path><path d='M 288,16 A 16,16 0 0,1 304,32' fill='none' stroke='currentColor'></path><path d='M 96,32 A 16,16 0 0,0 112,48' fill='none' stroke='currentColor'></path><path d='M 128,32 A 16,16 0 0,1 112,48' fill='none' stroke='currentColor'></path><path d='M 184,32 A 16,16 0 0,0 200,48' fill='none' stroke='currentColor'></path><path d='M 216,32 A 16,16 0 0,1 200,48' fill='none' stroke='currentColor'></path><path d='M 272,32 A 16,16 0 0,0 288,48' fill='none' stroke='currentColor'></path><path d='M 304,32 A 16,16 0 0,1 288,48' fill='none' stroke='currentColor'></path><circle cx='40' cy='32' r='6' stroke='currentColor' fill='currentColor'></circle><circle cx='360' cy='32' r='6' stroke='currentColor' fill='currentColor'></circle>
<style>  text {       text-anchor: middle;       font-family: "Menlo","Lucida Console","monospace";       fill: currentColor;       font-size: 1em;  }</style>
<text x='40' y='68'>b</text><text x='104' y='68'>b</text><text x='112' y='68'>b</text><text x='120' y='68'>e</text><text x='192' y='68'>b</text><text x='200' y='68'>e</text><text x='280' y='68'>b</text><text x='288' y='68'>e</text><text x='296' y='68'>e</text><text x='360' y='68'>e</text></g>
</svg>
<p>Now we can make four new elements. If we make them all, our list becomes</p>
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="89" width="600" font-family="Menlo,Lucida Console,monospace">
<style type="text/css">svg {   color: #000000;}@media (prefers-color-scheme: dark) {   svg {      color: #000000;   }}</style>
<g transform='translate(8,16)'><path d='M 40,32 L 72,32' fill='none' stroke='currentColor'></path><path d='M 112,32 L 144,32' fill='none' stroke='currentColor'></path><path d='M 184,32 L 216,32' fill='none' stroke='currentColor'></path><path d='M 256,32 L 288,32' fill='none' stroke='currentColor'></path><path d='M 328,32 L 360,32' fill='none' stroke='currentColor'></path><path d='M 400,32 L 432,32' fill='none' stroke='currentColor'></path><path d='M 472,32 L 504,32' fill='none' stroke='currentColor'></path><path d='M 544,32 L 576,32' fill='none' stroke='currentColor'></path><polygon points='80.000000,32.000000 68.000000,26.400000 68.000000,37.599998' fill='currentColor' transform='rotate(0.000000, 72.000000, 32.000000)'></polygon><polygon points='152.000000,32.000000 140.000000,26.400000 140.000000,37.599998' fill='currentColor' transform='rotate(0.000000, 144.000000, 32.000000)'></polygon><polygon points='224.000000,32.000000 212.000000,26.400000 212.000000,37.599998' fill='currentColor' transform='rotate(0.000000, 216.000000, 32.000000)'></polygon><polygon points='296.000000,32.000000 284.000000,26.400000 284.000000,37.599998' fill='currentColor' transform='rotate(0.000000, 288.000000, 32.000000)'></polygon><polygon points='368.000000,32.000000 356.000000,26.400000 356.000000,37.599998' fill='currentColor' transform='rotate(0.000000, 360.000000, 32.000000)'></polygon><polygon points='440.000000,32.000000 428.000000,26.400000 428.000000,37.599998' fill='currentColor' transform='rotate(0.000000, 432.000000, 32.000000)'></polygon><polygon points='512.000000,32.000000 500.000000,26.400000 500.000000,37.599998' fill='currentColor' transform='rotate(0.000000, 504.000000, 32.000000)'></polygon><polygon points='576.000000,32.000000 564.000000,26.400000 564.000000,37.599998' fill='currentColor' transform='rotate(0.000000, 576.000000, 32.000000)'></polygon><path d='M 96,16 A 16,16 0 0,0 80,32' fill='none' stroke='currentColor'></path><path d='M 96,16 A 16,16 0 0,1 112,32' fill='none' stroke='currentColor'></path><path d='M 168,16 A 16,16 0 0,0 152,32' fill='none' stroke='currentColor'></path><path d='M 168,16 A 16,16 0 0,1 184,32' fill='none' stroke='currentColor'></path><path d='M 240,16 A 16,16 0 0,0 224,32' fill='none' stroke='currentColor'></path><path d='M 240,16 A 16,16 0 0,1 256,32' fill='none' stroke='currentColor'></path><path d='M 312,16 A 16,16 0 0,0 296,32' fill='none' stroke='currentColor'></path><path d='M 312,16 A 16,16 0 0,1 328,32' fill='none' stroke='currentColor'></path><path d='M 384,16 A 16,16 0 0,0 368,32' fill='none' stroke='currentColor'></path><path d='M 384,16 A 16,16 0 0,1 400,32' fill='none' stroke='currentColor'></path><path d='M 456,16 A 16,16 0 0,0 440,32' fill='none' stroke='currentColor'></path><path d='M 456,16 A 16,16 0 0,1 472,32' fill='none' stroke='currentColor'></path><path d='M 528,16 A 16,16 0 0,0 512,32' fill='none' stroke='currentColor'></path><path d='M 528,16 A 16,16 0 0,1 544,32' fill='none' stroke='currentColor'></path><path d='M 80,32 A 16,16 0 0,0 96,48' fill='none' stroke='currentColor'></path><path d='M 112,32 A 16,16 0 0,1 96,48' fill='none' stroke='currentColor'></path><path d='M 152,32 A 16,16 0 0,0 168,48' fill='none' stroke='currentColor'></path><path d='M 184,32 A 16,16 0 0,1 168,48' fill='none' stroke='currentColor'></path><path d='M 224,32 A 16,16 0 0,0 240,48' fill='none' stroke='currentColor'></path><path d='M 256,32 A 16,16 0 0,1 240,48' fill='none' stroke='currentColor'></path><path d='M 296,32 A 16,16 0 0,0 312,48' fill='none' stroke='currentColor'></path><path d='M 328,32 A 16,16 0 0,1 312,48' fill='none' stroke='currentColor'></path><path d='M 368,32 A 16,16 0 0,0 384,48' fill='none' stroke='currentColor'></path><path d='M 400,32 A 16,16 0 0,1 384,48' fill='none' stroke='currentColor'></path><path d='M 440,32 A 16,16 0 0,0 456,48' fill='none' stroke='currentColor'></path><path d='M 472,32 A 16,16 0 0,1 456,48' fill='none' stroke='currentColor'></path><path d='M 512,32 A 16,16 0 0,0 528,48' fill='none' stroke='currentColor'></path><path d='M 544,32 A 16,16 0 0,1 528,48' fill='none' stroke='currentColor'></path><circle cx='40' cy='32' r='6' stroke='currentColor' fill='currentColor'></circle><circle cx='584' cy='32' r='6' stroke='currentColor' fill='currentColor'></circle>
<style>  text {       text-anchor: middle;       font-family: "Menlo","Lucida Console","monospace";       fill: currentColor;       font-size: 1em;  }</style>
<text x='40' y='68'>b</text><text x='88' y='68'>b</text><text x='96' y='68'>b</text><text x='104' y='68'>b</text><text x='112' y='68'>e</text><text x='160' y='68'>b</text><text x='168' y='68'>b</text><text x='176' y='68'>e</text><text x='224' y='68'>b</text><text x='232' y='68'>b</text><text x='240' y='68'>e</text><text x='248' y='68'>b</text><text x='256' y='68'>e</text><text x='304' y='68'>b</text><text x='312' y='68'>e</text><text x='368' y='68'>b</text><text x='376' y='68'>e</text><text x='384' y='68'>b</text><text x='392' y='68'>e</text><text x='400' y='68'>e</text><text x='448' y='68'>b</text><text x='456' y='68'>e</text><text x='464' y='68'>e</text><text x='520' y='68'>b</text><text x='528' y='68'>e</text><text x='536' y='68'>e</text><text x='544' y='68'>e</text><text x='584' y='68'>e</text></g>
</svg>
<p>We can continue making new elements forever and we’ll never make an element with the same name.</p>
</div>
<div id="squint-real-hard" class="section level2">
<h2>Squint Real Hard</h2>
<p>If we squint real hard, our strings of <strong>b</strong>s and <strong>e</strong>s map directly to the Farey numbers! The number of <strong>e</strong>s in the string is the numerator of the Farey number, and the length of the string is the denominator of the Farey number.</p>
<div class="yep">
<p><span class="math inline">\(\displaystyle b\)</span> has zero <strong>e</strong>s and its length is one so <span class="math inline">\(\displaystyle b=\frac{0}{1}\)</span></p>
<p><span class="math inline">\(\displaystyle e\)</span> has one <strong>e</strong> and its length is one so <span class="math inline">\(\displaystyle e=\frac{1}{1}\)</span></p>
<p><span class="math inline">\(\displaystyle be\)</span> has one <strong>e</strong> and its length is two so <span class="math inline">\(\displaystyle be=\frac{1}{2}\)</span></p>
<p><span class="math inline">\(\displaystyle bbe\)</span> has one <strong>e</strong> and its length is three so <span class="math inline">\(\displaystyle bbe=\frac{1}{3}\)</span></p>
<p><span class="math inline">\(\displaystyle bee\)</span> has two <strong>e</strong>s and its length is three so <span class="math inline">\(\displaystyle bbe=\frac{2}{3}\)</span></p>
<p>…and so on (promise)</p>
</div>
</div>
<div id="why-is-that-interesting" class="section level2">
<h2>Why is that interesting?</h2>
<p>If you use Farey numbers to name the elements of linked lists as they’re inserted, the structure (and a good bit of the history) of the linked list is completely specified by those names. You can break all the links and reassemble the list by starting at the empty list and following the Farey number generation process. The first element you insert will always be the one called <span class="math inline">\(\displaystyle\frac{1}{2}\)</span>, which will always make the <span class="math inline">\(\displaystyle\frac{1}{3}\)</span> and <span class="math inline">\(\displaystyle\frac{2}{3}\)</span> spots available for insert, and so on.</p>
<p>The Farey numbers are a neat coordinate system for linked lists.</p>
</div>
